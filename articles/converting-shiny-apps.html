<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Converting Shiny Apps to MCP Apps • shinymcp</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Converting Shiny Apps to MCP Apps">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">shinymcp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/converting-shiny-apps.html">Converting Shiny Apps</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/JamesHWade/shinymcp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Converting Shiny Apps to MCP Apps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/JamesHWade/shinymcp/blob/main/vignettes/converting-shiny-apps.Rmd" class="external-link"><code>vignettes/converting-shiny-apps.Rmd</code></a></small>
      <div class="d-none name"><code>converting-shiny-apps.Rmd</code></div>
    </div>

    
    
<p>MCP Apps are interactive UIs that render directly inside AI chat
interfaces like Claude Desktop. Unlike Shiny apps that run in a browser
with a persistent server, MCP Apps are lightweight HTML documents where
user interactions trigger <strong>tool calls</strong> — stateless R
functions that the AI host invokes on demand.</p>
<p>This vignette walks through converting a Shiny app into an MCP App
using shinymcp. We’ll use the classic Palmer Penguins explorer as a
worked example.</p>
<div class="section level2">
<h2 id="key-differences-from-shiny">Key differences from Shiny<a class="anchor" aria-label="anchor" href="#key-differences-from-shiny"></a>
</h2>
<p>Before converting, it helps to understand what changes:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th></th>
<th>Shiny</th>
<th>MCP App</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><strong>Runs in</strong></td>
<td>Browser tab</td>
<td>AI chat interface (iframe)</td>
</tr>
<tr class="even">
<td><strong>Server</strong></td>
<td>Persistent R process with reactive graph</td>
<td>Stateless tool calls</td>
</tr>
<tr class="odd">
<td><strong>Reactivity</strong></td>
<td>
<code><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive()</a></code>, <code><a href="https://rdrr.io/pkg/shiny/man/observe.html" class="external-link">observe()</a></code>,
<code>render*()</code>
</td>
<td>Tool function called on input change</td>
</tr>
<tr class="even">
<td><strong>UI framework</strong></td>
<td>shiny.js + WebSocket</td>
<td>Plain HTML + postMessage bridge</td>
</tr>
<tr class="odd">
<td><strong>State</strong></td>
<td>Server-side reactive values</td>
<td>Recomputed each tool call</td>
</tr>
<tr class="even">
<td><strong>Layout</strong></td>
<td>
<code><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage()</a></code>, <code><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout()</a></code>
</td>
<td>bslib (<code><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar()</a></code>, <code><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card()</a></code>)</td>
</tr>
</tbody>
</table>
<p>The core shift: <strong>flatten your reactive graph into tool
functions</strong>. Each connected group of inputs → reactives → outputs
becomes a single tool that accepts inputs as arguments and returns
outputs as a named list.</p>
</div>
<div class="section level2">
<h2 id="step-1-identify-inputs-and-outputs">Step 1: Identify inputs and outputs<a class="anchor" aria-label="anchor" href="#step-1-identify-inputs-and-outputs"></a>
</h2>
<p>Start with your Shiny app and list every input and output. Here’s a
typical penguins Shiny app:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># --- Original Shiny app ---</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://shiny.posit.co/" class="external-link">shiny</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/" class="external-link">palmerpenguins</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/titlePanel.html" class="external-link">titlePanel</a></span><span class="op">(</span><span class="st">"Palmer Penguins Explorer"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarPanel</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"Species"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="st">"x_var"</span>, <span class="st">"X axis"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bill_length_mm"</span>, <span class="st">"bill_depth_mm"</span>,</span>
<span>                                        <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/selectInput.html" class="external-link">selectInput</a></span><span class="op">(</span><span class="st">"y_var"</span>, <span class="st">"Y axis"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bill_depth_mm"</span>, <span class="st">"bill_length_mm"</span>,</span>
<span>                                        <span class="st">"flipper_length_mm"</span>, <span class="st">"body_mass_g"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/checkboxInput.html" class="external-link">checkboxInput</a></span><span class="op">(</span><span class="st">"trend"</span>, <span class="st">"Show trend line"</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">mainPanel</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/plotOutput.html" class="external-link">plotOutput</a></span><span class="op">(</span><span class="st">"scatter"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/textOutput.html" class="external-link">verbatimTextOutput</a></span><span class="op">(</span><span class="st">"stats"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">filtered_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">penguins</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span>, <span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">species</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="va">input</span><span class="op">$</span><span class="va">species</span>, <span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">data</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">scatter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html" class="external-link">renderPlot</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu">filtered_data</span><span class="op">(</span><span class="op">)</span>,</span>
<span>                <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">x_var</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">input</span><span class="op">$</span><span class="va">y_var</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                    color <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">trend</span><span class="op">)</span> <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>    <span class="va">p</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderPrint</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="fu">filtered_data</span><span class="op">(</span><span class="op">)</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">input</span><span class="op">$</span><span class="va">x_var</span>, <span class="va">input</span><span class="op">$</span><span class="va">y_var</span>, <span class="st">"species"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/shiny/man/shinyApp.html" class="external-link">shinyApp</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">server</span><span class="op">)</span></span></code></pre></div>
<p>From this app, we identify:</p>
<p><strong>Inputs:</strong></p>
<ul>
<li>
<code>species</code> — <code>selectInput</code> with 4 choices</li>
<li>
<code>x_var</code> — <code>selectInput</code> with 4 variable
choices</li>
<li>
<code>y_var</code> — <code>selectInput</code> with 4 variable
choices</li>
<li>
<code>trend</code> — <code>checkboxInput</code> (boolean)</li>
</ul>
<p><strong>Outputs:</strong></p>
<ul>
<li>
<code>scatter</code> — <code>plotOutput</code> (a ggplot scatter
plot)</li>
<li>
<code>stats</code> — <code>verbatimTextOutput</code> (summary
statistics)</li>
</ul>
<p><strong>Reactive logic:</strong></p>
<ul>
<li>
<code>filtered_data()</code> filters penguins by species</li>
<li>Both outputs depend on <code>filtered_data()</code> plus the
axis/trend inputs</li>
<li>Everything is connected — one reactive group → one tool</li>
</ul>
</div>
<div class="section level2">
<h2 id="step-2-map-components">Step 2: Map components<a class="anchor" aria-label="anchor" href="#step-2-map-components"></a>
</h2>
<p>Replace Shiny inputs with shinymcp equivalents:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Shiny</th>
<th>shinymcp</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>selectInput("species", "Species", choices)</code></td>
<td><code>mcp_select("species", "Species", choices)</code></td>
</tr>
<tr class="even">
<td><code>selectInput("x_var", "X axis", choices)</code></td>
<td><code>mcp_select("x_var", "X axis", choices)</code></td>
</tr>
<tr class="odd">
<td><code>checkboxInput("trend", "Show trend line")</code></td>
<td><code>mcp_checkbox("trend", "Show trend line")</code></td>
</tr>
<tr class="even">
<td><code>plotOutput("scatter")</code></td>
<td><code>mcp_plot("scatter")</code></td>
</tr>
<tr class="odd">
<td><code>verbatimTextOutput("stats")</code></td>
<td><code>mcp_text("stats")</code></td>
</tr>
</tbody>
</table>
<p>The IDs stay the same. The component APIs are intentionally
similar.</p>
</div>
<div class="section level2">
<h2 id="step-3-build-the-ui">Step 3: Build the UI<a class="anchor" aria-label="anchor" href="#step-3-build-the-ui"></a>
</h2>
<p>Use bslib for layout instead of Shiny’s <code><a href="https://rdrr.io/pkg/shiny/man/fluidPage.html" class="external-link">fluidPage()</a></code> /
<code><a href="https://rdrr.io/pkg/shiny/man/sidebarLayout.html" class="external-link">sidebarLayout()</a></code>. bslib components work directly with
htmltools — no Shiny server needed:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/JamesHWade/shinymcp" class="external-link">shinymcp</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/bslib/" class="external-link">bslib</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/htmltools" class="external-link">htmltools</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar</a></span><span class="op">(</span></span>
<span>  theme <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bs_theme</a></span><span class="op">(</span>preset <span class="op">=</span> <span class="st">"shiny"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Palmer Penguins Explorer"</span>,</span>
<span>  sidebar <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">sidebar</a></span><span class="op">(</span></span>
<span>    width <span class="op">=</span> <span class="fl">260</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_select.html">mcp_select</a></span><span class="op">(</span></span>
<span>      <span class="st">"species"</span>, <span class="st">"Species"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"All"</span>, <span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span><span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_select.html">mcp_select</a></span><span class="op">(</span><span class="st">"x_var"</span>, <span class="st">"X axis"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Bill Length (mm)"</span> <span class="op">=</span> <span class="st">"bill_length_mm"</span>,</span>
<span>      <span class="st">"Bill Depth (mm)"</span> <span class="op">=</span> <span class="st">"bill_depth_mm"</span>,</span>
<span>      <span class="st">"Flipper Length (mm)"</span> <span class="op">=</span> <span class="st">"flipper_length_mm"</span>,</span>
<span>      <span class="st">"Body Mass (g)"</span> <span class="op">=</span> <span class="st">"body_mass_g"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_select.html">mcp_select</a></span><span class="op">(</span><span class="st">"y_var"</span>, <span class="st">"Y axis"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"Bill Depth (mm)"</span> <span class="op">=</span> <span class="st">"bill_depth_mm"</span>,</span>
<span>      <span class="st">"Bill Length (mm)"</span> <span class="op">=</span> <span class="st">"bill_length_mm"</span>,</span>
<span>      <span class="st">"Flipper Length (mm)"</span> <span class="op">=</span> <span class="st">"flipper_length_mm"</span>,</span>
<span>      <span class="st">"Body Mass (g)"</span> <span class="op">=</span> <span class="st">"body_mass_g"</span></span>
<span>    <span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_checkbox.html">mcp_checkbox</a></span><span class="op">(</span><span class="st">"trend"</span>, <span class="st">"Show trend line"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Scatter Plot"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_plot.html">mcp_plot</a></span><span class="op">(</span><span class="st">"scatter"</span>, height <span class="op">=</span> <span class="st">"380px"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Summary Statistics"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_text.html">mcp_text</a></span><span class="op">(</span><span class="st">"stats"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Named choice vectors
(e.g. <code>"Bill Length (mm)" = "bill_length_mm"</code>) work exactly
like Shiny — the name is displayed, the value is sent to the tool.</p>
</div>
<div class="section level2">
<h2 id="step-4-convert-reactive-logic-to-a-tool">Step 4: Convert reactive logic to a tool<a class="anchor" aria-label="anchor" href="#step-4-convert-reactive-logic-to-a-tool"></a>
</h2>
<p>This is the key step. Flatten the reactive graph into a single
function:</p>
<ol style="list-style-type: decimal">
<li>The function <strong>arguments</strong> are the input values (with
sensible defaults)</li>
<li>The function <strong>body</strong> does what the reactives and
renderers did</li>
<li>The function <strong>returns</strong> a named list mapping output
IDs to values</li>
</ol>
<p>For plots, render to a temporary PNG and return the base64-encoded
image. The bridge displays it as an <code>&lt;img&gt;</code>
element.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tools</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/tool.html" class="external-link">tool</a></span><span class="op">(</span></span>
<span>    fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span></span>
<span>      <span class="va">species</span> <span class="op">=</span> <span class="st">"All"</span>,</span>
<span>      <span class="va">x_var</span> <span class="op">=</span> <span class="st">"bill_length_mm"</span>,</span>
<span>      <span class="va">y_var</span> <span class="op">=</span> <span class="st">"bill_depth_mm"</span>,</span>
<span>      <span class="va">trend</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">palmerpenguins</span><span class="fu">::</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/reference/penguins.html" class="external-link">penguins</a></span></span>
<span>      <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/stats/complete.cases.html" class="external-link">complete.cases</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="op">]</span></span>
<span></span>
<span>      <span class="co"># Filter (was: filtered_data reactive)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">species</span> <span class="op">!=</span> <span class="st">"All"</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">[</span><span class="va">data</span><span class="op">$</span><span class="va">species</span> <span class="op">==</span> <span class="va">species</span>, <span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span></span>
<span>      <span class="co"># Plot (was: renderPlot)</span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>        <span class="va">data</span>,</span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">x_var</span><span class="op">]</span><span class="op">]</span>, y <span class="op">=</span> <span class="va">.data</span><span class="op">[[</span><span class="va">y_var</span><span class="op">]</span><span class="op">]</span>, color <span class="op">=</span> <span class="va">species</span><span class="op">)</span></span>
<span>      <span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.7</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>        <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span>base_size <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span>
<span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Logic.html" class="external-link">isTRUE</a></span><span class="op">(</span><span class="va">trend</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span></span>
<span>      <span class="co"># Render plot to base64 PNG</span></span>
<span>      <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".png"</span><span class="op">)</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="va">p</span>, width <span class="op">=</span> <span class="fl">7</span>, height <span class="op">=</span> <span class="fl">4</span>, dpi <span class="op">=</span> <span class="fl">144</span>, bg <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/on.exit.html" class="external-link">on.exit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">plot_b64</span> <span class="op">&lt;-</span> <span class="fu">base64enc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/base64enc/man/base64.html" class="external-link">base64encode</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Summary text (was: renderPrint)</span></span>
<span>      <span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/capture.output.html" class="external-link">capture.output</a></span><span class="op">(</span><span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Observations: %d penguins\n\n"</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x_var</span>, <span class="va">y_var</span>, <span class="st">"species"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="op">}</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span></span>
<span></span>
<span>      <span class="co"># Return named list: keys must match output IDs</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>scatter <span class="op">=</span> <span class="va">plot_b64</span>, stats <span class="op">=</span> <span class="va">stats</span><span class="op">)</span></span>
<span>    <span class="op">}</span>,</span>
<span>    name <span class="op">=</span> <span class="st">"explore_penguins"</span>,</span>
<span>    description <span class="op">=</span> <span class="st">"Explore the Palmer Penguins dataset with scatter plots"</span>,</span>
<span>    arguments <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      species <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"Species filter: All, Adelie, Chinstrap, or Gentoo"</span><span class="op">)</span>,</span>
<span>      x_var <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"X axis variable name"</span><span class="op">)</span>,</span>
<span>      y_var <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_string</a></span><span class="op">(</span><span class="st">"Y axis variable name"</span><span class="op">)</span>,</span>
<span>      trend <span class="op">=</span> <span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/type_boolean.html" class="external-link">type_boolean</a></span><span class="op">(</span><span class="st">"Whether to show a linear trend line"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Important details:</p>
<ul>
<li><p><strong>Return keys match output IDs</strong>:
<code>list(scatter = ..., stats = ...)</code> corresponds to
<code>mcp_plot("scatter")</code> and <code>mcp_text("stats")</code>. The
bridge uses these keys to route values to the correct output
elements.</p></li>
<li><p><strong>Base64 plots</strong>: Use <code><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave()</a></code> or
<code><a href="https://rdrr.io/r/grDevices/png.html" class="external-link">png()</a></code> + <code><a href="https://rdrr.io/r/grDevices/dev.html" class="external-link">dev.off()</a></code>, then
<code><a href="https://rdrr.io/pkg/base64enc/man/base64.html" class="external-link">base64enc::base64encode()</a></code>. The bridge wraps this in an
<code>&lt;img&gt;</code> tag.</p></li>
<li><p><strong>Text output</strong>: <code><a href="../reference/mcp_text.html">mcp_text()</a></code> renders in
a <code>&lt;pre&gt;</code> tag, so R’s <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> and
<code><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat()</a></code> output preserves column alignment.</p></li>
<li><p><strong>Default arguments</strong>: Every argument needs a
default value. This is what the tool uses when loaded initially and what
the AI sees as the expected format.</p></li>
<li><p><strong>Stateless</strong>: No <code><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal()</a></code>, no
<code>&lt;&lt;-</code>, no session state. Each tool call recomputes from
scratch. For most apps this is fine since tool calls are fast.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="step-5-assemble-and-serve">Step 5: Assemble and serve<a class="anchor" aria-label="anchor" href="#step-5-assemble-and-serve"></a>
</h2>
<p>Wire up the UI, tools, and server:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">app</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mcp_app.html">mcp_app</a></span><span class="op">(</span><span class="va">ui</span>, <span class="va">tools</span>, name <span class="op">=</span> <span class="st">"penguins-explorer"</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/serve.html">serve</a></span><span class="op">(</span><span class="va">app</span><span class="op">)</span></span></code></pre></div>
<p>Save this as a single <code>app.R</code> file. To register it with
Claude Desktop, add an entry to your Claude Desktop config
(<code>~/Library/Application Support/Claude/claude_desktop_config.json</code>
on macOS):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  <span class="dt">"mcpServers"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="dt">"penguins"</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>      <span class="dt">"command"</span><span class="fu">:</span> <span class="st">"/opt/homebrew/bin/Rscript"</span><span class="fu">,</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>      <span class="dt">"args"</span><span class="fu">:</span> <span class="ot">[</span><span class="st">"/path/to/your/app.R"</span><span class="ot">]</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>Restart Claude Desktop, and the app will appear as an interactive UI
when the <code>explore_penguins</code> tool is called.</p>
</div>
<div class="section level2">
<h2 id="conversion-patterns">Conversion patterns<a class="anchor" aria-label="anchor" href="#conversion-patterns"></a>
</h2>
<div class="section level3">
<h3 id="one-reactive-group-one-tool">One reactive group → one tool<a class="anchor" aria-label="anchor" href="#one-reactive-group-one-tool"></a>
</h3>
<p>If all your outputs share the same reactive dependencies, they belong
in a single tool. This is the most common case:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Shiny: two outputs from one reactive</span></span>
<span><span class="va">server</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">input</span>, <span class="va">output</span>, <span class="va">session</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/reactive.html" class="external-link">reactive</a></span><span class="op">(</span><span class="op">{</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">==</span> <span class="va">input</span><span class="op">$</span><span class="va">cyl</span>, <span class="op">]</span> <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPlot.html" class="external-link">renderPlot</a></span><span class="op">(</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span>
<span>  <span class="va">output</span><span class="op">$</span><span class="va">text</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/shiny/man/renderPrint.html" class="external-link">renderText</a></span><span class="op">(</span><span class="op">{</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"cars"</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># MCP App: one tool returning both</span></span>
<span><span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/tool.html" class="external-link">tool</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">cyl</span> <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">data</span> <span class="op">&lt;-</span> <span class="va">mtcars</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">cyl</span> <span class="op">==</span> <span class="va">cyl</span>, <span class="op">]</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>      plot <span class="op">=</span> <span class="fu">render_plot_base64</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">mpg</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      text <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>, <span class="st">"cars"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  <span class="co"># ...</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="independent-outputs-multiple-tools">Independent outputs → multiple tools<a class="anchor" aria-label="anchor" href="#independent-outputs-multiple-tools"></a>
</h3>
<p>If outputs have completely independent inputs, use separate tools.
The bridge calls all tools whose inputs changed:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Tool 1: only uses the "dataset" input</span></span>
<span><span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/tool.html" class="external-link">tool</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span> <span class="op">=</span> <span class="st">"mtcars"</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"summarize_data"</span>,</span>
<span>  <span class="co"># ...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Tool 2: only uses the "n" input</span></span>
<span><span class="fu">ellmer</span><span class="fu">::</span><span class="fu"><a href="https://ellmer.tidyverse.org/reference/tool.html" class="external-link">tool</a></span><span class="op">(</span></span>
<span>  fun <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">{</span> <span class="va">...</span> <span class="op">}</span>,</span>
<span>  name <span class="op">=</span> <span class="st">"generate_sample"</span>,</span>
<span>  <span class="co"># ...</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="replacing-reactiveval-session-state">Replacing <code>reactiveVal</code> / session state<a class="anchor" aria-label="anchor" href="#replacing-reactiveval-session-state"></a>
</h3>
<p>MCP tool calls are stateless. If your Shiny app uses
<code><a href="https://rdrr.io/pkg/shiny/man/reactiveVal.html" class="external-link">reactiveVal()</a></code> or <code><a href="https://rdrr.io/pkg/shiny/man/reactiveValues.html" class="external-link">reactiveValues()</a></code> to
accumulate state across interactions, you have two options:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Recompute from inputs</strong>: Most filtering/selection
state can be derived from the current input values alone.</p></li>
<li><p><strong>Use the file system</strong>: For truly stateful apps
(e.g., a todo list), write state to a temp file and read it back on the
next tool call.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h3>
<p>For <code>tableOutput</code>, return an HTML table string.
<code><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">knitr::kable()</a></code> is the easiest approach:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fun</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">dataset</span> <span class="op">=</span> <span class="st">"mtcars"</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="va">dataset</span>, envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ns-internal.html" class="external-link">asNamespace</a></span><span class="op">(</span><span class="st">"datasets"</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    my_table <span class="op">=</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="va">data</span>, format <span class="op">=</span> <span class="st">"html"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Use <code>mcp_table("my_table")</code> in the UI. The bridge sets
<code>innerHTML</code> directly.</p>
</div>
<div class="section level3">
<h3 id="dynamic-ui">Dynamic UI<a class="anchor" aria-label="anchor" href="#dynamic-ui"></a>
</h3>
<p>MCP Apps don’t support <code><a href="https://rdrr.io/pkg/shiny/man/renderUI.html" class="external-link">renderUI()</a></code> /
<code><a href="https://rdrr.io/pkg/shiny/man/htmlOutput.html" class="external-link">uiOutput()</a></code>. Instead:</p>
<ul>
<li>Use <code>mcp_html(id)</code> and return HTML strings from the
tool</li>
<li>For show/hide, return an empty string when the element should be
hidden</li>
<li>For dynamic choices, use a fixed <code><a href="../reference/mcp_select.html">mcp_select()</a></code> and
document valid values in the tool description</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="layout-with-bslib">Layout with bslib<a class="anchor" aria-label="anchor" href="#layout-with-bslib"></a>
</h2>
<p>Since MCP Apps use htmltools directly (not Shiny’s
<code>fluidPage</code>), use bslib for layout. Common patterns:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Sidebar layout</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/page_sidebar.html" class="external-link">page_sidebar</a></span><span class="op">(</span></span>
<span></span>
<span>  sidebar <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/sidebar.html" class="external-link">sidebar</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/mcp_select.html">mcp_select</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"Variable"</span>, <span class="va">choices</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="../reference/mcp_checkbox.html">mcp_checkbox</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="st">"Log scale"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="../reference/mcp_plot.html">mcp_plot</a></span><span class="op">(</span><span class="st">"main_plot"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="../reference/mcp_text.html">mcp_text</a></span><span class="op">(</span><span class="st">"summary"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Multi-column layout</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/page.html" class="external-link">page</a></span><span class="op">(</span></span>
<span>  theme <span class="op">=</span> <span class="fu"><a href="https://rstudio.github.io/bslib/reference/bs_theme.html" class="external-link">bs_theme</a></span><span class="op">(</span>preset <span class="op">=</span> <span class="st">"shiny"</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/layout_columns.html" class="external-link">layout_columns</a></span><span class="op">(</span></span>
<span>    col_widths <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Plot"</span><span class="op">)</span>, <span class="fu"><a href="../reference/mcp_plot.html">mcp_plot</a></span><span class="op">(</span><span class="st">"plot1"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Table"</span><span class="op">)</span>, <span class="fu"><a href="../reference/mcp_table.html">mcp_table</a></span><span class="op">(</span><span class="st">"table1"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Stacked cards</span></span>
<span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/page.html" class="external-link">page</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Controls"</span><span class="op">)</span>, <span class="fu"><a href="../reference/mcp_select.html">mcp_select</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"Pick"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rstudio.github.io/bslib/reference/card.html" class="external-link">card</a></span><span class="op">(</span><span class="fu"><a href="https://rstudio.github.io/bslib/reference/card_body.html" class="external-link">card_header</a></span><span class="op">(</span><span class="st">"Output"</span><span class="op">)</span>, <span class="fu"><a href="../reference/mcp_text.html">mcp_text</a></span><span class="op">(</span><span class="st">"result"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>All CSS and JS dependencies from bslib are automatically inlined into
the MCP App’s HTML resource.</p>
</div>
<div class="section level2">
<h2 id="what-cant-be-converted">What can’t be converted<a class="anchor" aria-label="anchor" href="#what-cant-be-converted"></a>
</h2>
<p>Some Shiny features don’t have MCP App equivalents:</p>
<ul>
<li>
<strong><code>fileInput</code></strong>: MCP Apps can’t receive file
uploads. Use <code><a href="../reference/mcp_text_input.html">mcp_text_input()</a></code> for file paths instead, or
have the tool read from a known directory.</li>
<li>
<strong>Shiny modules with internal state</strong>: Flatten the
module logic into top-level tools.</li>
<li>
<strong><code>invalidateLater</code> / polling</strong>: MCP tools
are request-response only. No background updates.</li>
<li>
<strong>JavaScript-heavy widgets</strong> (DT, plotly, leaflet):
These require Shiny’s JS runtime. Use static alternatives (base R plots,
<code><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">knitr::kable</a></code> tables).</li>
</ul>
</div>
<div class="section level2">
<h2 id="full-example">Full example<a class="anchor" aria-label="anchor" href="#full-example"></a>
</h2>
<p>The complete converted penguins app is available at:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"examples"</span>, <span class="st">"penguins"</span>, <span class="st">"app.R"</span>, package <span class="op">=</span> <span class="st">"shinymcp"</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by James Wade.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
